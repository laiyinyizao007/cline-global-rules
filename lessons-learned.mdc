# 经验教训

**项目特定的学习日志和最佳实践**

---

## 使用说明

这是一个活文档，用于记录在项目开发过程中学到的重要经验、模式和偏好。

### 记录内容
- 关键的实施路径和决策
- 用户偏好和工作流程
- 项目特定的模式和约定
- 已知的挑战和解决方案
- 工具使用技巧
- 架构演变的原因

### 何时更新
- 发现重要的项目模式时
- 做出重大技术决策后
- 遇到并解决挑战时
- 优化或重构代码后

---

## 经验教训模板

```markdown
### [类别] - [简短标题] - [日期]

**背景：**
[描述情况或问题的背景]

**学到的经验：**
[详细说明学到了什么]

**应用：**
[如何在项目中应用这个经验]

**影响：**
[这个经验对项目的影响]

**相关资源：**
- [文档链接]
- [参考资料]

---
```

## 项目偏好

### 开发工作流程
[记录项目特定的开发工作流程和偏好]

---

## 架构决策

### 决策 1：PowerShell 终端编码问题 - 2025-11-03

**背景：**
在使用 enhance 命令时，Windows PowerShell 5.x 用户看到 emoji 乱码（`ðŸ¤–` 而不是 🤖）。这个问题暴露了两个关键问题：
1. 环境配置问题（PowerShell 编码）
2. **enhance 系统本身无法自动检测和记录这类问题**

**考虑的选项：**
1. 修改 Python 脚本移除所有 emoji（降低用户体验）
2. 要求用户手动配置 PowerShell（增加门槛）
3. 提供自动配置脚本（最佳平衡）
4. 推荐使用 PowerShell 7（长期解决方案）

**选择的方案：**
多层解决方案：
- 创建 fix-encoding.ps1 自动配置脚本
- 提供完整技术文档
- 在 README 中添加警告
- 推荐使用 PowerShell 7

**理由：**
- 不降低用户体验（保留 emoji）
- 提供快速修复方案（一键配置）
- 兼顾新老用户（PowerShell 5.x 和 7）
- 提供完整文档支持

**权衡：**
- 优点：问题得到完整解决，用户体验良好
- 缺点：需要额外的配置步骤

**关键发现：**
**enhance 系统的根本性缺陷：**
1. ❌ **被动分析**：只能分析已记录的错误，无法主动发现新问题
2. ❌ **依赖人工**：需要人工先记录错误，才能生成建议
3. ❌ **没有实时监控**：无法在问题发生时立即检测
4. ❌ **无上下文感知**：不知道当前用户正在经历什么

**改进方向：**
1. ✅ 添加实时问题检测（如检测终端编码）
2. ✅ 集成日志分析（分析命令输出）
3. ✅ 添加环境检测（PowerShell 版本、编码设置）
4. ✅ 自动记录新问题到 error-documentation.mdc


**示例：**
- 使用 Git Flow 分支策略
- 所有 PR 需要至少一人审核
- 运行完整测试套件后才能合并

### 代码风格
[记录项目特定的代码风格偏好]

**示例：**
- 使用 Black 进行 Python 代码格式化
- 最大行长度：100 字符
- 使用类型提示

### 工具使用
[记录项目中使用的工具和技巧]

**示例：**
- 使用 pytest 进行测试
- 使用 pre-commit hooks 确保代码质量
- 使用 GitHub Actions 进行 CI/CD

---

## 架构决策

### 决策 1：[决策标题] - [日期]

**背景：**
[为什么需要做这个决策]

**考虑的选项：**
1. [选项 1]
2. [选项 2]
3. [选项 3]

**选择的方案：**
[最终选择的方案]

**理由：**
[为什么选择这个方案]

**权衡：**
[这个决策的优点和缺点]

---

## 实施模式

### 模式 1：[模式名称]

**问题：**
[这个模式解决什么问题]

**解决方案：**
[如何实现这个模式]

**代码示例：**
```python
# 示例代码
```

**何时使用：**
[在什么情况下使用这个模式]

**注意事项：**
[使用时需要注意什么]

---

## 已知挑战

### 挑战 1：[挑战描述] - [日期]

**问题：**
[详细描述挑战]

**解决方法：**
[如何解决或缓解这个挑战]

**经验总结：**
[从这个挑战中学到什么]

---

## 性能优化

### 优化 1：[优化描述] - [日期]

**性能问题：**
[描述遇到的性能问题]

**瓶颈分析：**
[如何识别瓶颈]

**优化措施：**
[采取了什么优化措施]

**效果：**
[优化后的效果，最好有数据]

---

## 团队协作

### 沟通偏好
[记录团队沟通偏好和约定]

### 会议记录
[重要会议的决策和行动项]

### 知识分享
[团队内部分享的重要知识点]

---

## 技术栈经验

### [技术名称]

**优点：**
- [优点 1]
- [优点 2]

**缺点：**
- [缺点 1]
- [缺点 2]

**使用技巧：**
- [技巧 1]
- [技巧 2]

**常见陷阱：**
- [陷阱 1]
- [陷阱 2]

---

## 调试经验

### 常见问题和解决方案
[记录经常遇到的问题和快速解决方法]

### 调试技巧
[记录有效的调试技巧]

---

## 未来改进

### 短期改进
- [ ] [改进项 1]
- [ ] [改进项 2]

### 长期改进
- [ ] [改进项 1]
- [ ] [改进项 2]

---

## 资源和参考

### 有用的文档
- [文档 1]
- [文档 2]

### 相关项目
- [项目 1]
- [项目 2]

### 学习资源
- [资源 1]
- [资源 2]

---

**注意：** 这个文件应该随着项目的发展而不断更新和完善。定期回顾和更新可以帮助团队保持一致性和提高效率。
