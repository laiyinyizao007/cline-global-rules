# 项目记忆库系统 (Memory Files)

**始终包含此文件以获取项目上下文**

---

## 记忆文件结构

记忆文件系统由核心文件（必需）和上下文文件（可选）组成。文件之间建立清晰的层次关系：

```
产品需求文档 (PRD)
  ↓
架构设计 + 技术规范
  ↓
任务计划
  ↓
活动上下文
  ↓
错误文档 + 经验教训
```

---

## 核心文件（必需）- 7 个文件

### 1. 产品需求文档 (docs/product_requirement_docs.md)
**用途：** 项目的产品需求文档 (PRD) 或标准操作程序 (SOP)

**包含内容：**
- 项目存在的原因
- 要解决的问题
- 定义核心需求和目标
- 作为塑造所有其他文件的基础文档
- 项目范围的真实来源
- 在项目开始时创建（如果不存在）

### 2. 系统架构 (docs/architecture.md)
**用途：** 系统架构文档

**包含内容：**
- 系统如何工作
- 组件关系
- 依赖关系
- 解决方案的工作流程
- 解决方案概览的 Mermaid 图表：每个组件和代码流

### 3. 技术规范 (docs/technical.md)
**用途：** 开发环境和技术栈

**包含内容：**
- 使用的技术
- 开发设置
- 关键技术决策
- 使用的设计模式
- 技术约束

### 4. 任务计划 (tasks/tasks_plan.md)
**用途：** 详细的任务积压

**包含内容：**
- 深入的任务列表和项目进度
- 什么是有效的
- 还要构建什么
- 当前状态
- 已知问题

### 5. 活动上下文 (tasks/active_context.md)
**用途：** 当前开发状态

**包含内容：**
- 当前工作重点
- 活动决策和考虑
- 最近的变化
- 下一步

### 6. 错误文档 (.clinerules/error-documentation.mdc)
**用途：** 错误和修复的知识库

**包含内容：**
- 在此项目中发现的可重用修复
- 收到的更正
- 已知问题：它们的状态、上下文和解决方案

**使用说明：** 在交互过程中，如果您发现对此项目中的错误的修复或收到可重用的更正，应在此文件中记录，以便不再犯同样的错误。

### 7. 经验教训 (.clinerules/lessons-learned.mdc)
**用途：** 每个项目的学习日志

**包含内容：**
- 它捕获重要的模式、偏好和项目智能
- 关键的实施路径
- 用户偏好和工作流程
- 项目特定模式
- 已知挑战
- 项目决策的演变
- 工具使用模式

---

## 上下文文件（可选）

### 1. 文献调研 (docs/literature/)
- 包含文献调研和研究（可以是 LaTeX、Markdown 或其他格式）
- 每个文献主题一个文件

### 2. RFC 文档 (tasks/rfc/)
- 包含 tasks_plan.md 中每个单独任务的 RFC
- RFC 可以是 LaTeX、Markdown 或其他格式
- 为特定功能提供详细规范和讨论

### 3. 其他文档
可以在 `docs/` 或 `tasks/` 中添加其他文件或文件夹作为记忆文件，当它们有助于组织时：
- 集成规范
- 测试策略
- 基准测试设置
- 可能的扩展
- 部署程序

---

## 核心工作流程

系统在不同的模式下运行：**PLAN（规划）模式** 和 **ACT（实现）模式**，由用户输入或当前请求中的任务控制。

### PLAN 模式工作流程

```
开始
  ↓
读取记忆文件（docs/ 和 tasks/）
  ↓
文件完整？
  ├─ 否 → 创建计划 → 在聊天中记录
  └─ 是 → 验证上下文 → 制定策略 → 呈现方法
           ↓
        方法已验证？
           ├─ 否 → 寻求澄清 → 返回制定策略
           └─ 是 → 记录到记忆文件
```

### ACT 模式工作流程

```
开始
  ↓
检查记忆文件（核心文件始终检查，其余根据上下文）
  ↓
更新文档
  ↓
更新经验教训和错误文档（如果需要）
  ↓
执行任务
  ↓
在记忆文件中记录更改
```

---

## 文档更新时机

记忆文件更新发生在：
1. 发现新的项目模式时
2. 实施重大更改后
3. 当用户请求 **"更新记忆文件"** 时（必须审查所有核心文件）
4. 需要澄清上下文时
5. 在计划的重要部分得到验证后

**更新流程：**
1. 审查核心文件
2. 在 active_context.md 和 tasks_plan.md 中记录当前状态
3. 在 tasks_plan.md 中明确下一步并记录
4. 更新 lessons-learned.mdc 和 error-documentation.mdc
5. 更新 architecture.md（如果架构有变化）

**注意：** 当触发 **"更新记忆文件"** 时，我必须审查每个核心记忆文件，即使某些不需要更新。特别关注 active_context.md 和 tasks_plan.md，因为它们跟踪当前状态。

---

## 项目智能 (lessons-learned.mdc)

lessons-learned.mdc 文件是每个项目的学习日志。它捕获重要的模式、偏好和项目智能，帮助更有效地工作。在与项目合作时，会发现并记录从代码本身并不明显的关键见解。

### 捕获内容
- 关键的实施路径
- 用户偏好和工作流程
- 项目特定模式
- 已知挑战
- 项目决策的演变
- 工具使用模式

格式灵活 - 重点是捕获有价值的见解，帮助更有效地与您和项目合作。将 lessons-learned.mdc 视为一个活文档，随着我们合作而变得更智能。

---

## MCP Memory 工具集成

本系统与 MCP Memory 工具深度集成，形成双层记忆系统：

### 文件层（结构化文档）
- PRD、架构、技术文档
- 任务计划和活动上下文
- 提供完整的项目视图

### MCP 层（知识图谱）
- 实体：项目、模块、概念
- 关系：依赖、继承、关联
- 观察：决策、模式、经验

### 整合方式
1. **PRD → 实体创建**
   - 项目名称、目标、需求作为实体
   - 建立核心概念关系

2. **架构 → 关系映射**
   - 组件间依赖关系
   - 系统流程关系

3. **活动上下文 → 观察记录**
   - 当前决策作为观察
   - 临时信息和进度

4. **经验教训 → 知识积累**
   - 模式作为实体
   - 教训作为观察

---

## 使用指南

### 对于新项目
1. 创建所有核心文件
2. 填写 PRD 定义项目
3. 设计架构和技术栈
4. 创建初始任务计划
5. 使用 MCP Memory 记录关键概念

### 对于现有项目
1. 审查现有代码和文档
2. 创建/更新核心文件
3. 记录当前状态
4. 使用 MCP Memory 构建知识图谱
5. 持续更新和维护

### 日常使用
- **规划时**：读取所有核心文件，使用 PLAN 模式
- **实现时**：读取相关文档，使用 ACT 模式
- **调试时**：查阅错误文档和经验教训
- **定期**：更新活动上下文和任务计划

---

## 中文编码规范整合

记忆库系统与您现有的中文编码规范完全兼容：

**参考文档：**
- **C:\Dev\rules\ai-instructions\general-rules.md** - 通用编码规范
- **C:\Dev\rules\ai-instructions\cline-specific.md** - Cline 特定规则
- **C:\Dev\templates\** - 项目模板

**MCP 工具：**
- **Filesystem MCP** - 文件操作
- **Memory MCP** - 知识图谱
- **GitHub MCP** - 代码管理
- **Puppeteer MCP** - 浏览器自动化

---

**记住：** 记忆库是项目的大脑，保持它的更新和准确是高质量 AI 辅助开发的关键！
